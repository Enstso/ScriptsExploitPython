# format ip : 192.168.x.x/24
# interface eth0/ps0/ens0

from scapy.all import *
import sys
import pyfiglet

banner = pyfiglet.figlet_format("Net_Scanner")
print(banner)

try:
        ip = sys.argv[1]
        interface = sys.argv[2]
        broadcastMac = "ff:ff:ff:ff:ff:ff"

        paquet = Ether(dst=broadcastMac)/ARP(pdst = ip) 
        
        response, noResponse = srp(paquet, timeout=2, iface=interface, inter=0.1)
        
        print("Les machines du réseau "+  str(ip)+":")
        
        for snd,rcv in response:
                print (rcv.sprintf(r"MAC : %Ether.src% -- IP : %ARP.psrc%"))
except IndexError:
        print("Il y a un soucis | vos paramètres (ip,interface)")
        pass