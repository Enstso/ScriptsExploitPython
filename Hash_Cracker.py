# Le premier paramètre est le hash
# Deuxième paramètre est une liste ex: rockyou.txt
# Il faudra dans certaines situaton convertir la liste en utf8 ex :
# iconv -f ISO-8859-1 -t UTF-8 /usr/share/wordlists/rockyou.txt > /usr/share/wordlists/rockyou_utf8.txt
import pyfiglet
import hashlib
import sys
banner = pyfiglet.figlet_format("Hash_Cracker")
print(banner)


try:
    hash = sys.argv[1]
    wordlist = sys.argv[2]
    print("Choissisez votre algorithme :")
    print("0. md5")
    print("1. sha1")
    print("2. sha224")
    print("3. sha256")
    print("4. sha384")
    print("5. sha512")
    choice = int(input())
    match choice:
        case 0:

            print("Recherche...")
            with open(wordlist,'r') as file:
                for line in file.readlines():
                    hashTemp = hashlib.md5(line.strip().encode()).hexdigest()
                    if hash == hashTemp:
                        print("Le mot en clair : "+ str(line))
                        exit(0)
        case 1:
            print("Recherche...")
            with open(wordlist,'r') as file:
                for line in file.readlines():
                    hashTemp = hashlib.sha1(line.strip().encode()).hexdigest()
                    if hash == hashTemp:
                        print("Le mot en clair : "+ str(line))
                        exit(0)
        case 2:
            print("Recherche...")
            with open(wordlist,'r') as file:
                for line in file.readlines():
                    hashTemp = hashlib.sha224(line.strip().encode()).hexdigest()
                    if hash == hashTemp:
                        print("Le mot en clair : "+ str(line))
                        exit(0)
        case 3:
            print("Recherche...")
            with open(wordlist,'r') as file:
                for line in file.readlines():
                    hashTemp = hashlib.sha256(line.strip().encode()).hexdigest()
                    if hash == hashTemp:
                        print("Le mot en clair : "+ str(line))
                        exit(0)
        case 4:
            print("Recherche...")
            with open(wordlist,'r') as file:
                for line in file.readlines():
                    hashTemp = hashlib.sha384(line.strip().encode()).hexdigest()
                    if hash == hashTemp:
                        print("Le mot en clair : "+ str(line))
                        exit(0)
        case 5:
            print("Recherche...")
            with open(wordlist,'r') as file:
                for line in file.readlines():
                    hashTemp = hashlib.sha512(line.strip().encode()).hexdigest()
                    if hash == hashTemp:
                        print("Le mot en clair : "+ str(line))
                        exit(0)
except IndexError:
    print("Les paramètres (le hash, la liste)")